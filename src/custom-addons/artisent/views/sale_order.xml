<?xml version="1.0"?>
<odoo>
    <record id="view_sale_order_form_quote_filter" model="ir.ui.view">
        <field name="name">view.sale.order.form.quote.filter</field>
        <field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <field name="sale_order_template_id" position="attributes">
                <attribute name="domain">[('partner_id', '=', partner_id)]</attribute>
            </field>
            <xpath expr="//sheet/notebook/page[1]/field/tree/field[4]" position="after">
                <field name="instructions"/>
            </xpath>
            <field name="fsm_location_id" position="attributes">
                <attribute name="context">{'sale_order': True}</attribute>
            </field>
            <field name="require_payment" position="after">
                <field name="so_warning_override"/>
            </field>
            <xpath expr="//field[@name='warehouse_id']"
                   position='replace'/>
            <xpath expr="//field[@name='analytic_account_id']"
                   position='replace'/>
            <xpath expr="//field[@name='analytic_segment_one_id']"
                   position='replace'/>
            <field name="payment_mode_id" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="payment_term_id" position="after">
                <field name="warehouse_id" options="{'no_create': True}" groups="stock.group_stock_multi_locations"/>
                <field name="analytic_account_id" context="{'default_partner_id':partner_invoice_id, 'default_name':name}" attrs="{'readonly': [('invoice_count','!=',0),('state','=','sale')]}" groups="analytic.group_analytic_accounting" force_save="1" string="Store"/>
                <field name="analytic_segment_one_id"/>
                <field name="request_early"/>
                <field name="request_late"/>
                <field name="po_ref"/>
            </field>
            <xpath expr="/form/header/button[8]" position="attributes">
                <attribute name="attrs">{'invisible': ['|', ('opportunity_id', '!=', False), ('state', 'not in', ['sent'])]}</attribute>
            </xpath>
            <xpath expr="/form/header/button[9]" position="attributes">
                <attribute name="attrs">{'invisible': ['|', ('opportunity_id', '!=', False), ('state', 'not in', ['draft'])]}</attribute>
            </xpath>
        </field>
    </record>

    <record id="sale_order_view_form_inherit_button" model="ir.ui.view">
        <field name="name">sale.order.form.inherit.button</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <button name="%(sale.action_view_sale_advance_payment_inv)d"
                type="action" context="{'default_advance_payment_method': 'percentage'}"
                position="attributes">
                <attribute name="attrs">{'invisible': ['|', '|', ('invoice_status', '!=', 'no'), ('state', '!=', 'sale'), ('fsm_order_count', '!=', 0)]}</attribute>
            </button>
        </field>
    </record>

    <record id="sale_order_update_form_view_inherit" model="ir.ui.view">
        <field name="name">sale.order.update.form.view.inherit</field>
        <field name="model">sale.order</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="avatax_connector.sale_order_update_form_view"/>
        <field name="arch" type="xml">
            <field name="exemption_code" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="exemption_code_id" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="location_code" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="tax_on_shipping_address" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>

    <record id="view_order_form_payment_method_inherit" model="ir.ui.view">
        <field name="name">order.form.payment.method.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="osi_payment_method.view_order_form_payment_method"/>
        <field name="arch" type="xml">
            <field name="payment_method" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>

    <record id="view_order_form_with_carrier_inherit" model="ir.ui.view">
        <field name="name">delivery.sale.order.form.view.with_carrier.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="delivery.view_order_form_with_carrier"/>
        <field name="arch" type="xml">
            <label for="carrier_id" position="attributes">
                <attribute name="invisible">1</attribute>
            </label>
            <div name='carrier_selection' position="attributes">
                <attribute name="invisible">1</attribute>
            </div>
        </field>
    </record>

    <record id="sale_order_template_view_form_partner" model="ir.ui.view">
        <field name="name">sale.order.template.view.form.partner</field>
        <field name="model">sale.order.template</field>
        <field name="inherit_id" ref="sale_management.sale_order_template_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet/group/group" position="inside">
                <field name="partner_id"/>
                <field name="fsm_location_id"/>
            </xpath>
            <xpath expr="//sheet/notebook/page[1]/field/tree/field[3]" position="after">
                <field name="instructions"/>
            </xpath>

        </field>
    </record>

    <record id="sale_order_template_view_tree_partner" model="ir.ui.view">
        <field name="name">sale.order.template.view.form.partner</field>
        <field name="model">sale.order.template</field>
        <field name="inherit_id" ref="sale_management.sale_order_template_view_tree"/>
        <field name="arch" type="xml">
            <field name="name" position="after">
                <field name="partner_id"/>
            </field>
        </field>
    </record>

    <record id="sale_order_template_view_search_partner" model="ir.ui.view">
        <field name="name">sale.order.template.view.search.partner</field>
        <field name="model">sale.order.template</field>
        <field name="inherit_id" ref="sale_management.sale_order_template_view_search"/>
        <field name="arch" type="xml">
            <filter name="inactive" position="before">
                <field name="partner_id"/>
            </filter>
        </field>
    </record>

    <!-- Added so Artisent can manually specify how much to Invoice -->
    <record id="sale_order_line_to_invoice" model="ir.ui.view">
        <field name="name">sale.order.line.to.invoice</field>
        <field name="model">sale.order.line</field>
        <field name="inherit_id" ref="sale.sale_order_line_view_form_readonly"/>
        <field name="arch" type="xml">
            <field name="qty_invoiced" position="after">
                <field name="qty_to_invoice_fsm"/>
            </field>
        </field>
    </record>

    <!-- Hide Create Invoice on SO if there is an FSO attached -->
    <record id="sale_order_artisent_button" model="ir.ui.view">
        <field name="name">sale.order.artisent.button</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_management.sale_order_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[1]" position="after">
                <field name="hide_invoice_btn" invisible="1"/>
            </xpath>
            <xpath expr="//button[3]" position="attributes">
                <attribute name="attrs">{'invisible': ['|', ('invoice_status', '!=', 'to invoice'), ('hide_invoice_btn', '!=', False)]}</attribute>
            </xpath>
            <xpath expr="//button[4]" position="attributes">
                <attribute name="attrs">{'invisible': ['|', '|', ('invoice_status', '!=', 'no'), ('state', '!=', 'sale'), ('hide_invoice_btn', '!=', False)]}</attribute>
            </xpath>
        </field>
    </record>

      <!-- Hide Create Invoice on SO if there is an FSO attached -->
    <record id="sale_order_hide_style" model="ir.ui.view">
        <field name="name">sale.order.hide.style</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="professional_templates.view_sale_order_inherit_customized"/>
        <field name="arch" type="xml">
            <field name="style" position="attributes">
                <attribute name="attrs">{'invisible': True}</attribute>
            </field>
        </field>
    </record>

    <record id="view_order_tree_inherit_artisent" model="ir.ui.view">
        <field name="name">sale.order.tree.inherit.artisent</field>
        <field name="model">sale.order</field>
        <field name="priority">2</field>
        <field name="inherit_id" ref="sale.view_order_tree"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="fsm_location_id"/>
            </field>
            <field name="confirmation_date" position="replace">
                <field name="request_early"/>
            </field>
        </field>
    </record>

    <record id="artisent_add_service_agreement" model="ir.ui.view">
        <field name="name">artisent.add.service.agreement</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="fieldservice_sale.view_order_form_inherit_sale_fieldservice"/>
        <field name="arch" type="xml">
            <field name="fsm_location_id" position="after">
                <field name="service_requirement"/>
            </field>
        </field>
    </record>

    <menuitem id="menu_product_pricelist_main" 
              name="Pricelists" 
              parent="sale.product_menu_catalog" 
              action="product.product_pricelist_action2" 
              groups="sales_team.group_sale_salesman" 
              sequence="3" 
              active="False"/>


</odoo>
