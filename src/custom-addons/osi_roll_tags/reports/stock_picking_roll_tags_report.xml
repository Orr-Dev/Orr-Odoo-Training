<odoo>
    <data>
        <report
            string="Roll Tags"
            id="action_roll_tags"
            model="stock.picking"
            report_type="qweb-pdf"
            name="osi_roll_tags.report_roll_tags"
            file="osi_roll_tags.report_roll_tags"
            print_report_name="'Roll Tag - %s - %s' % (object.partner_id.name or '', object.name)"
            menu="False"
        />

        <template id="report_roll_tags">
            <t t-call="web.basic_layout">
                <t t-foreach="docs" t-as="o">
                    <t t-set="has_barcode" t-value="any([move_ids_without_package.product_id and move_ids_without_package.product_id.sudo().barcode or move_ids_without_package.package_id for move_ids_without_package in o.move_line_ids])"/>
                    <t t-set="has_serial_number" t-value="o.move_line_ids.filtered(lambda ml: ml.lot_id or ml.lot_name)" groups="stock.group_production_lot"/>
                    <t t-foreach="o.move_ids_without_package.sorted(key=lambda m: m.product_id.id)" t-as="move">
                        <t t-foreach="move.move_line_ids.sorted(key=lambda ml: ml.location_id.id)" t-as="ml">
                        <t t-set="quantity" t-value="int(ml.qty_done)"/>
                            <div class="page" style="page-break-after:always;">
                                <h6>Name</h6>
                                <div name="product">
                                    <span t-field="ml.product_id.display_name" style="font-size:32px"/>
                                    <span t-field="ml.product_id.description_picking" style="font-size:32px"/>
                                </div>
                                <h6>Lot Serial Number</h6>
                                <div name="lot_sn_number">
                                    <span t-field="ml.lot_name" style="font-size:92px"/>
                                </div>
                                <h6>Dye Lot</h6>
                                <div name="dye_lot">
                                    <span t-field="ml.dye_lot" style="font-size:52px"/>
                                </div>
                                <h6>Delivered Qty</h6>
                                <div name="delivered_qty">
                                    <span t-field="ml.qty_done" style="font-size:32px"/>
                                    <span t-field="ml.product_uom_id" style="font-size:32px"/>
                                </div>
                                <h6>Barcode</h6>
                                <div name="barcode">
                                    <span t-if="move.product_id and move.product_id.barcode">
                                        <img t-if="len(move.product_id.barcode) == 13" t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s&amp;humanreadable=1' % ('EAN13', move.product_id.barcode, 600, 100)" style="width:50%;height:135px" alt="Barcode"/>
                                        <img t-elif="len(move.product_id.barcode) == 8" t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s&amp;humanreadable=1' % ('EAN8', move.product_id.barcode, 600, 100)" style="width:50%;height:135px" alt="Barcode"/>
                                        <img t-else="" t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s&amp;humanreadable=1' % ('Code128', move.product_id.barcode, 600, 100)" style="width:50%;height:105px" alt="Barcode"/>
                                    </span>
                                </div>
                            </div>
                        </t>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>
